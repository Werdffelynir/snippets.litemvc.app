<!--DECLARATION
ID:             156
TITLE:          sql create table
CATEGORY:       sql   
SUBCATEGORY:    create  
-->[code=sql]--Создание таблицы, добавление, изменение и удаление записей при помощи sql
CREATE TABLE citys(id INT NOT NULL PRIMARY KEY AUTO_INCREMENT, name CHAR(100) NOT NULL, city CHAR(100) NOT NULL) character set utf8;

--Добавим несколько записей:
INSERT INTO citys (city, name) VALUE(`Москва`, `Локомотив`), (`Москва`, `Спартак`), (`Казань`, `Рубин`);

--Изменение записи:
UPDATE citys SET city = `Белгород`, name=`Салют` WHERE name=`Рубин`;

--Удаление записи:
DELETE FROM citys where id=1;



-- Выбор данных из таблицы
-- -----------------------

--Выбрать все записи из таблицы «citys»:
SELECT * FROM citys;

--Вычисляемые поля: вывести зарплату, надбавку, общую сумму и процент надбавки из таблицы:
SELECT name, rise, salary, salary+rise, rise*100/salary FROM teacher;

--Получаем произвольную строку в результате выполнения запроса:
SELECT `Преподаватель `, name, ` имеет ставку: `, salary from teacher;

--Выбираем, без повторений, все города из таблицы:
SELECT DISTINCT city FROM citys;

--Иногда, чтобы не писать длинные названия таблиц и полей или для наглядности, лучше, используя «AS», задать им синоним:
SELECT name AS `Имя` FROM teacher WHERE post=LOVER(`декан`) (LOVER — переводит текст в нижний регистр, UPPER — в верхний);

--Использование «NOT» (Выбрать все города кроме Москвы):
SELECT * FROM citys WHERE NOT city=`Москва`;

--Вывести города названия которых начинается на букву, расположенную до буквы «С»:
SELECT city FROM citys WHERE city<`С`;

--Примеры с «LIKE»-ом (Выбрать города начинающиеся на букву «C»)
SELECT * FROM sitys WHERE city LIKE `C%`;

--Выбрать города в названии которых встречается две буквы «а»:
SELECT * FROM `citys` WHERE city LIKE `%а%а%`;

--Выбрать города которые начинаются на «Б» и третья буква «л»:
SELECT * FROM `citys` WHERE city LIKE `Б_л%`;



-- Работа с полями типа «DATE» и «DATETIME»
-- -----------------------

--Выбрать преподавателей, принятых на работу позже 02.04.2013:
SELECT * FROM `teacher` WHERE datep>`2013-04-02`;

--Выбрать преподавателей, принятых на работу между 01.04.2013 и 03.04.2013:
SELECT * FROM teacher WHERE datep BETWEEN (`2013-04-01`) and (`2013-04-03`);

--Представление даты и времени в «нормальном» виде(13.11.2013 16:15:14):
SELECT DATE_FORMAT(datep, `%d.%m.%Y %H:%i:%s`) AS `дата`, name FROM teacher;

--Иногда необходимо выбирать данные из таблицы по нескольким условиям одного поля.
--Например: выбрать из таблицы teather всех «профессоров» и «деканов». В таком случае лучше воспользоваться «IN».
SELECT * FROM `teacher` WHERE post IN (`профессор`,`декан`);

--Рассмотрим пример выбора данных из таблицы с использованием подзапросов. Принцип работы такой конструкции очень прост — сначала выполняется подзапрос, а затем и сам запрос. Решим такую задачу: выбрать из таблицы комментариев «comments» те записи, которые не относятся ни к одной из статей таблицы «posts».
SELECT id FROM comments WHERE id_post NOT IN (SELECT id FROM posts);

--Часто необходимо вывести из таблицы не повторяющиеся записи. Здесь нам поможет «DISTINCT». Задача: из таблицы «clubs» вывести все города без повторений.
SELECT DISTINCT cyty FROM clubs;

--Зачастую необходимо что-то подсчитать, для этого можно(нужно) использовать «COUNT». Задача: посчитать сколько в таблице «city» городов на букву «Х».
SELECT COUNT(*) FROM city WHERE name LIKE `Х%`;

--Задачи на поиск чего-то минимального и максимального решаются при помощи «MAX» и «MIN». Задача:выбрать минимальный и максимальный «id» из таблицы «city».
SELECT MIN(id) AS `минимальный`, max(id) as `максимальный` FROM city;
--Задача 2: из таблицы «citys» выбрать, по алфавиту, «первый» и «последний» город.
SELECT MIN(city) AS `миним.`, MAX(city) AS `максим.`;

--Если стоит задача упорядочить данные, то в SQL есть: «ORDER BY»(упорядочить по), «DESC»(убыванию) и «ASC»(возрастанию). Задача: из таблицы «city» выбрать все города, упорядочив их по убыванию.
SELECT * FROM city ORDER BY city_name DESC;
--Также возможно упорядочить по двум полям:
SELECT * FROM city ORDER BY city_name, id DESC;

--Использование «GROUP BY» и «HAVING» на примере задачи: вывести названия городов, в которых больше одного клуба, и их количество.
SELECT city_name, count(*) AS `Количество` FROM city GROUP BY city_name HAVING count(*)>1;

--Когда нужно перебирать все варианты сочетания полей таблицы/таблиц используется «JOIN». Задача: из таблицы «commands» выбрать команды таким образом чтобы получилась турнирная таблица, в которой каждая команда встретилась по-разу с другой.
SELECT t1.command_name, t2.command_name FROM commands t1 JOIN commands t2 WHERE t1.id <> t2.id AND t1.id > t2.id;
[/code]